!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.NewFeatureLibrary=t():e.NewFeatureLibrary=t()}(self,(function(){return function(){"use strict";var e={d:function(t,r){for(var i in r)e.o(r,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:r[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.r(t),e.d(t,{NewFeaturesService:function(){return n}});class i{constructor(e){r(this,"_groups",void 0),this._groups=e}compatible(e,t){if(!e)return e;for(let r=0;r<this._groups.length;r++){const i=this._groups[r];if(!t||i&t){const t=e&i;if(t)return t}}return 0}}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class n{get shownNewFeatures(){return this._shownNewFeatures}get _newFeatures$(){return this._promise$||(this._promise$=this._provider.getNewFeatures()),this._promise$}constructor(e,t){this._provider=e,s(this,"_shownNewFeatures",0),s(this,"_promise$",void 0),s(this,"_compatibilityService",void 0),s(this,"_subscriptions",[]),this._compatibilityService=new i(t)}async availableFeatures(e){const t=await this._newFeatures$&e;return t&this._compatibilityService.compatible(t,this._shownNewFeatures)}async showAvailableFeatures(e){const t=await this.availableFeatures(e);return t&&(this._shownNewFeatures|=t),t}async isNewFeature(e){return(await this.availableFeatures(e)&e)===e}async markNewFeatureAsUsed(e){const t=await this.isNewFeature(e);return t&&this._provider.markNewFeatureAsUsed(e),t}hide(e){this._shownNewFeatures&=~e}subscribeOnChangeState(e){this._subscriptions.find((t=>t===e))||(this._subscriptions.push(e),1===this._subscriptions.length&&this._provider.subscribeOnChangeState(this.refreshNewFeatures.bind(this)))}unsubscribeFromChangeState(e){const t=this._subscriptions.indexOf(e);-1===t&&(this._subscriptions.splice(t,1),this._subscriptions.length||this._provider.unsubscribeFromChangeState(this.refreshNewFeatures.bind(this)))}refreshNewFeatures(){this._promise$=this._provider.getNewFeatures(),this._newFeatures$.then((()=>{this._subscriptions.forEach((e=>e()))}))}}return t}()}));
//# sourceMappingURL=new-features-service.js.map